# PyPy

## 简介

* 是CPython的替代品，实现了全部的python语言特性
* 平均相对于CPython，有4.8倍的性能提升
* 使用JIT（Just-in-Time）编译器，在运行时将Python代码编译为机器码。
* 可能减少内存使用
* 对Python代码有极强的兼容性，并且对C扩展提供了部分适配

## 不生效的场景

* 整体运行时间短，PyPy还没来得及准备
* 非Python代码，如C扩展，PyPy无法通过编译Python代码提升效率

## 内置工具vmprof

* 内置的vmprof是一个开销很低的统计分析器
* cProfile可能会扭曲统计结果

## 优化策略

* 优化前先确定效率基准
* PyPy只能优化计算密集型程序
* 算法优化往往比执行效率优化更有效
* 首先关注循环中的耗时操作 
* 在不降低算法效率的前提下，集中运算数据，以提高缓存命中率

## 使用技巧（包括无效技巧）

* 越简单的代码约有利于PyPy优化
* 在PyPy中，不需要将全局变量优化为局部变量
* 提前编译正则表达式，PyPy无法完成正则表达式的编译优化
* PyPy不能很好地优化反射和动态类型
